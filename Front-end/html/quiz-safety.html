<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Introduction Quiz</title>
    <link rel="stylesheet" href="../CSS/quiz_introduction.css">
</head>
<body>
    <!-- Header -->
    <header>
        <div class="logo">Cyberstarter</div>
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="Courses.html">Courses</a></li>
                <li><a href="Quiz-layout.html">Quiz</a></li>
                <li><a href="Resources.html">Resources</a></li>
                <li><a href="About-us.html">About Us</a></li>
                <li><a href="Contact.html">Contact</a></li>
                <li></li>
            </ul>
        </nav>
    </header>

    <!--Quiz Container-->
    <div class="quiz-container">
        <div id="quiz">
            <div id="question" class="question"></div>
            <ul id="options" class-option></ul>
            <button id="submit" class="btn">Submit Answer</button>
            <div id="result" class="result"></div>
        </div>
    </div>

    <footer>
        <div class="footer-content">
            <div class="quick-links">
                <a href="Privacy.html">Privacy Policy</a>
                <a href="Terms.html">Terms of Use</a>
                <a href="#">Help Center</a>
            </div>
            <div class="contact-info">
                <p>Email: support@cyberstart.com</p>
                <p>Phone: 123-456-7890</p>
            </div>
        </div>
    </footer>

    <sccript>
        let websocket;
        let currentQuestion = null;
        let score = 0;
        let totalQuestions = 0;

        // Connects to the WebSocket server
        function connectWebSocket() {
            websocket = new Websocket('ws://localhost:1234');

            websocket.onopen = function() {
                console.log("Connected to the WebSocket server.");
            };

            websocket.onmessage = function(event) {
                handleMessage(event.data);
            };

            websocket.onclose = function() {
                console.log("Disconnected from the WebSocket server.");
            };

            websocket.onclose = function() {
                console.log("Disconnected from the WebSocket server.");
            };

            websocket.onerror = function(error) {
                console.error("WebSocket error: ", error);
            };
        }

        // Handles incoming messages from the server
        function handleMessage(data) {
            const questionData = JSON.parse(data);

            // Checks if it's the score message
            if (questionData !== undefined) {
                document.getElementById('result').textContent = `Your score: ${questionData.score} out of ${questionData.total}`;
                document.getElementById('question').style.display = 'none';
                document.getElementById('options').style.display = none;
                document.getElementById('submit').style.display = none;
                return;
            }

            // Displays the questions and options
            currentQuestion = questionData;
            totalQuestions++;
            displayQuestion();
        }

        // Displays the current question and options
        function displayQuestion() {
            document.getElementById('question').textContent = currentQuestion.question;
            const optionselement = document.getElementById('options');
            optionsElement.innerHTML = '';

            currentQuestion.options.forEach((option, index) => {
                const li = document.createElemnet('li');
                li.innerHTML = `
                <input type="radio" name="option" id="option${index}" value="${option}">
                <label for="option${index}">${option}</label>
                `;
                optionsElement.appendChild(li);
            })

            // Handles answer submission
            document.getElementById('submit').addEventListener('click', ()  => {
                const selectedOPtion = document.querySelector('input[name="option"]:checked');
                if (!selectedOPtion) {
                    alert('Please select an answer!');
                }

                // Send the selected answer to the server
                websocket.send(selectedOPtion.value);
                // Clear the options for the next question
                document.getElementById('options').innerHTML = '';
            });

            // Start the WebSocket connection
            connectWebSocket();
        }
    </sccript>
    </body>
    </html>